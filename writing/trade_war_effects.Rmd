---
title: "The Trade War Effect on Donald Trump's Approval Rate"
author: "Abby Johnson and Haokun Zhang"
date: "5/13/2022"
output: pdf_document
bibliography: citing.bib
---

```{r setup, include=FALSE}
#import modules
library(dplyr)
library(ggplot2)
library(rdrobust)
library(magrittr)
library(haven)
library(tidyverse)
library(data.table)
library(fixest)
library(glue)
library(data.table)
library(caret)
library(glmnet)
library(gbm)
library(ggmap)
library(rpart)
library(rpart.plot)
library(randomForest)
library(rsample)
library(modelr)
library(fastDummies)
library(scales)
library(here)
library(knitr)
library(kableExtra)
library(stargazer)
library(here)
library(foreach)
library(rddensity)
library(dplyr)
library(modelsummary)

path <- here()
```

# Introduction

This paper's purpose is to use RD to determine the impact of Trade War on Donald Trump's approval rate during his presidency.

# Background

The trade war is arguably one of the most impactful actions that Donald Trump has made in his term of office. In 2018 he started a trade war with the world involving multiple battles with China as well as other American trade partners (EU, Canada, Mexico, etc.) Trump imposed tariffs and/or quotas on imports from the trade partners of the U.S. using a particular US legal rationale, such as "global safeguard" restrictions. Subsequent retaliation by trading partners and the further escalation between China and America has affected a list of items across industries, significantly risked trades, investment as well as the global economy [@Timeline]. In Joseph R. Biden Jr.'s presidency the tariffs on steel and aluminum was lifted or eased but some imposed tariffs remain.

Multiple paperwork provided evidence that the adverse economic effects of trade wars. Simulation of this possible China-US trade war estimated that the trade war would hurt manufacturing employment, and both export and import in the US, but would gain on welfare, GDP, and non-manufacturing production [@LiChunding2018] . After Trump's announcement the first tariff and the following retaliations from targeted countries, economists estimated a welfare cost of around \$6.9 billion during only the first 11 months of 2018, the U.S. tariffs were almost passed through into U.S. domestic prices, trade war created an additional cost of \$12.3 billion to the consumers [@AmitiMary2019]. Among the most significant trade events in the recent history, the overall welfare impacts of trade war were modest, ranged from -0.2% to -0.4% for the United States, sectoral revenue and the pattern of international trade are largely affected[@LiMinghao2020TUtw].

Retaliations from the US's trade partners have political impacts as well, they have not only disproportionately targeted more Republican areas, but they were also carefully targeted to hurt Trump. A relevant industry's concentration in Republican-leaning districts is systematically associated with higher probability of being targeted in early rounds of retaliation. Strong evidence shows that for every percentage point increase in the share of workers exposed to China's retaliatory tariffs, the Republican share of the vote decreased by 0.12 to 0.47 percentage points compared to the previous election, depending on the time of exposure [@KimSungEun2021]. A similar negative association was found between local exposure of the economic consequences of the trade war and the decline in support and a loss of seats for Republican candidates in the 2018 House elections[@BownChadP2019]. Empirical evidence from individual-level data and county-level data shows that counties that are more exposed to retaliatory tariff had higher levels of support for Trump in the 2016 presidential election: the counties most exposed to EU retaliation saw an average swing in the Republican candidates' vote share of 22% verses counties not exposed to EU retaliation [@Thiemo2021]. Individuals living in the counties under the highest EU retaliation exposure would be characterized by a 31.5% higher propensity to express a favorable view of Trump as a candidate, and for China's retaliation, the propensity is 11.6% [@Thiemo2021]. Targeting of Republican counties in swing districts appears to be concentrated in the first two rounds of retaliation. While a ten-percentage-point increase in the two-party vote share of the Republican party is associated with a 0.12 percentage point increase in the share of the targeted workforce in non-swing districts, the targeted share of the workforce is higher by 0.5 points in swing districts [@KimSungEun2021]. The retaliatory tariffs appear to have a clear political purpose: damage Donald Trump's support rates in the red states and swing states.

# Data

To examine trade war and its electoral consequences, we developed a regression discontinuity in time model. Combining with approval ratings of Donald Trump during his term of office, we measure the percentage change of Donald Trump's estimated job approval rates from registered or likely voter polls.

Historically, the president's approval ratings have been one of the best indicators of how his party will fare in congressional elections [@fivethirtyeight]. Therefore, we use a dataset that was made by FiveThirtyEight, and published to Kaggle [@Kaggle; @fivethirtyeight]. It contains a trendline of Donald Trump's low, high, and estimated job approval ratings across January 23rd, 2017, to September 15th, 2020, as well as his low, high, and estimated job disapproval rating across the same period. All the polls collected are considered real, scientific surveys, they are weighed based on their methodological standards, historical accuracy, sample size and how often a pollster measures Trump's approval ratings, as well as a series of rigorous adjustments. The approval ratings polls included only registered or likely voter polls. For this study, we use Donald Trump's estimated approval rate from January 23rd, 2017 to September 15th, 2020 as the key value.

```{r data_descripton, echo = FALSE}
#import data
trump_vote = read.csv("C:/Users/Haokun Zhang/Desktop/github/trade_war_effects/data/approval_topline.csv")

#filter the data to only voters
voter_data = trump_vote %>%
  filter(subgroup == "Voters")
voter_data = voter_data %>%
  select(subgroup, 
         modeldate, 
         approve_estimate, 
         approve_hi, 
         approve_lo, 
         disapprove_estimate, 
         disapprove_hi, 
         disapprove_lo) 

# create a dataframe of voter_data
df_voter_data <- data.frame(modeldate = c(voter_data$modeldate), 
                            approve_estimate = c(voter_data$approve_estimate))

# change the approve_estimate to log form
df_voter_data$log_approve_estimate=log(df_voter_data$approve_estimate)

# describing modeldate in date class
df_voter_data$modeldate <- as.Date(voter_data$modeldate, format = "%m/%d/%Y")

#add dummy variable for control covariates
df_voter_data$T1<-ifelse(df_voter_data$modeldate> "2018-03-01",1,0)
df_voter_data$T2<-ifelse(df_voter_data$modeldate> "2018-03-23",1,0)
df_voter_data$T3<-ifelse(df_voter_data$modeldate> "2018-05-17",1,0)
df_voter_data$T4<-ifelse(df_voter_data$modeldate> "2018-06-22",1,0)
df_voter_data$T5<-ifelse(df_voter_data$modeldate> "2018-07-01",1,0)
df_voter_data$T6<-ifelse(df_voter_data$modeldate> "2018-07-24",1,0)
df_voter_data$T7<-ifelse(df_voter_data$modeldate> "2018-09-24",1,0)
df_voter_data$T8<-ifelse(df_voter_data$modeldate> "2020-01-24",1,0)
df_voter_data$pandemic<-ifelse(df_voter_data$modeldate> "2020-03-13",1,0)

cov = cbind(df_voter_data$T1, df_voter_data$T2, df_voter_data$T3,
df_voter_data$T4, df_voter_data$T5, df_voter_data$T6, df_voter_data$T7, df_voter_data$T8, df_voter_data$pandemic)

# plot of distribution across time with both cutoff dates
p <- ggplot(data = df_voter_data, aes(x=modeldate, y=approve_estimate)) + geom_line() + scale_x_date(date_labels = "%Y/%m/%d") + geom_vline(xintercept = as.Date("2018-04-02"), color = "red")

# show p
plot(p)
```

# Research Design

While evaluating a question of how a policy would change the approval rate of one party, there is no cross-sectional variation in treatment-only one party is observed at a given time, so no difference-in-differences is possible. However, it is possible to estimate the impact under a regression discontinuity (RD) context. In this study, we used regression discontinuity in time (RDiT) to measure the trade war's effect on Donald Trump's approval rate. Different from cross-sectional RD, the running variable is time itself in the RDiT framework, and time cannot be thought of as randomly assigned within a neighborhood around a threshold like RD framework assigning randomized experiment [@2018RDiT]. In our model, the date of retaliatory tariffs went into effect $c$ is the cutoff point. For all dates $t>c$, Trump's job approval rate is affected, and for all dates $t<c$, it is not. China imposing its first retaliatory tariff on US products in April, 2, 2018 and in June 15, 2018 China issued an updated retaliation list targeting roughly \$45 billion of US exports to China in 2017, including a lot of agricultural and food products [@Timeline]. The two tariffs have heavy impact on the US trade and domestic consumers. April 2, 2018 is the first date of the US facing retaliatory tariff, and US faced one of the most heavy tariff from China since the trade war started.

During Trump's presidency, other unobservable events have effects on his approval rate as well, they are correlated with the running variable and may have discontinuous impacts on the potential outcome. We include control variables such as other imposed tariffs to US exports from 2018 to 2019, as well as Donald Trump's subsidies for American farmers after export fallout in July 24, 2018. In March 13, 2020, the first case of COVID-19 in US was announced, we include this event as control as well.

# Discussion of Results

```{r "local_linear_RD_point_estimator_with h=20_and_uniform_kernel", echo=FALSE}
cutoff = as.numeric(as.Date("2018-04-02"))

m1 = rdrobust(df_voter_data$approve_estimate, df_voter_data$modeldate, kernel = "triangular", p =1, bwselect = "mserd", c= cutoff, all=TRUE)

m2 = rdrobust(df_voter_data$approve_estimate, df_voter_data$modeldate, kernel = "triangular", p =1, bwselect = "mserd", c= cutoff, all=TRUE, covs = cov)

m3 = rdrobust(df_voter_data$approve_estimate, df_voter_data$modeldate, kernel = "triangular", p =2, bwselect = "mserd", c= cutoff, all = TRUE)

m4 = rdrobust(df_voter_data$approve_estimate, df_voter_data$modeldate, kernel = "triangular", p =2, bwselect = "mserd", all=TRUE, c= cutoff, covs = cov)

```

```{r cutoff1 models table, echo=FALSE}
tidy.rdrobust <- function(model, ...) {
  ret <- data.frame(
    term = row.names(model$coef),
    estimate = model$coef[, 1],
    std.error = model$se[, 1],
    p.value = model$pv[, 1]
  )
  row.names(ret) <- NULL
  ret
}

glance.rdrobust <- function(model, ...) {
  ret <- data.frame(
    Kernel = model$kernel,
    Bandwidth = model$bwselect
  )
  ret
}

models <- list(m1, m2, m3, m4)

modelsummary(models, statistic = "std.error", stars=TRUE, title = "RD Estimates for Approval Rate after U.S. Tariffs")

```

```{r rdplot, echo=FALSE}

## Implement rdplot 
y = (df_voter_data$approve_estimate)
x = as.integer(df_voter_data$modeldate)
c= as.integer(as.Date("2018-04-2"))

rdplot(y, x, c=c, p=1, binselect="es", covs =cov,
       title="RD Plot: Trump Approval Rate over Time", 
       y.label="Approval Estimate",
       x.label="Date (as integer)")
```

```{r two_plot, echo= FALSE}
rdplot(y, x, c=c, p=2, binselect="es", covs =cov,
       title="RD Plot: Trump Approval Rate over Time", 
       y.label="Approval Estimate",
       x.label="Date (as integer)")

rdplot(y, x, c=c, p=3, binselect="es", covs =cov,
       title="RD Plot: Trump Approval Rate over Time", 
       y.label="Approval Estimate",
       x.label="Date (as integer)")
```

```{r cutoff1 continuity assumption, echo=FALSE}
cutoff = as.numeric(as.Date("2018-04-02"))
x = as.integer(df_voter_data$modeldate)

df_voter_data <- df_voter_data %>% 
  mutate(
    D  = if_else(df_voter_data$modeldate > cutoff, 1, 0),
    y1 = 8811.5 + 0 * D + 1.5 * x + rnorm(n(), 0, 20)
  )

ggplot(aes(x, y1, colour = factor(D)), data = df_voter_data) +
  geom_point(alpha = 0.5) +
  geom_vline(xintercept = cutoff, colour = "grey", linetype = 2)+
  stat_smooth(method = "lm", se = F) +
  labs(x = "Test score (X)", y = "Potential Outcome (Y1)")

# continuity assumption holds
```

```{r data_descripton_2, echo = FALSE}
p2 <- ggplot(data = df_voter_data, aes(x=modeldate, y=approve_estimate)) + geom_line() + scale_x_date(date_labels = "%Y/%m/%d") + geom_vline(xintercept = as.Date("2018-07-06"), color = "red")
plot(p2)
```

```{r cutoff2 models, echo=FALSE}
cutoff = as.integer(as.Date("2018-07-06"))

m5 = rdrobust(df_voter_data$approve_estimate, df_voter_data$modeldate, kernel = "triangular", p =1, bwselect = "mserd", c= cutoff, all=TRUE)

m6 = rdrobust(df_voter_data$approve_estimate, df_voter_data$modeldate, kernel = "triangular", p =1, bwselect = "mserd", c= cutoff, all=TRUE, covs = cov)

m7 = rdrobust(df_voter_data$approve_estimate, df_voter_data$modeldate, kernel = "triangular", p =2, bwselect = "mserd", c= cutoff, all = TRUE)

m8 = rdrobust(df_voter_data$approve_estimate, df_voter_data$modeldate, kernel = "triangular", p =2, bwselect = "mserd", all=TRUE, c= cutoff, covs = cov)
```

```{r cutoff2 models table, echo=FALSE}
tidy.rdrobust <- function(model, ...) {
  ret <- data.frame(
    term = row.names(model$coef),
    estimate = model$coef[, 1],
    std.error = model$se[, 1],
    p.value = model$pv[, 1]
  )
  row.names(ret) <- NULL
  ret
}

glance.rdrobust <- function(model, ...) {
  ret <- data.frame(
    Kernel = model$kernel,
    Bandwidth = model$bwselect
  )
  ret
}

models <- list(m5, m6, m7, m8)

modelsummary(models, statistic = "std.error", stars=TRUE, title = "RD Estimates for Approval Rate after China Tariffs")

```

```{r cutoff2 rdplot, echo=FALSE}
y = (df_voter_data$approve_estimate)
x = as.integer(df_voter_data$modeldate)
c= as.integer(as.Date("2018-07-06"))

rdplot(y, x, c=c, p=1, binselect="es", covs =cov,
       title="RD Plot: Trump Approval Rate over Time", 
       y.label="Approval Estimate",
       x.label="Date (as integer)")

rdplot(y, x, c=c, p=2, binselect="es", covs =cov,
       title="RD Plot: Trump Approval Rate over Time", 
       y.label="Approval Estimate",
       x.label="Date (as integer)")

rdplot(y, x, c=c, p=3, binselect="es", covs =cov,
       title="RD Plot: Trump Approval Rate over Time", 
       y.label="Approval Estimate",
       x.label="Date (as integer)")
```

```{r cutoff2 continuity assumption, echo=FALSE}
cutoff = as.numeric(as.Date("2018-07-06"))
x = as.integer(df_voter_data$modeldate)

df_voter_data <- df_voter_data %>% 
  mutate(
    D  = if_else(df_voter_data$modeldate > cutoff, 1, 0),
    y1 = 8859 + 0 * D + 1.5 * x + rnorm(n(), 0, 20)
  )

ggplot(aes(x, y1, colour = factor(D)), data = df_voter_data) +
  geom_point(alpha = 0.5) +
  geom_vline(xintercept = cutoff, colour = "grey", linetype = 2)+
  stat_smooth(method = "lm", se = F) +
  labs(x = "Test score (X)", y = "Potential Outcome (Y1)")

#continuity assumption holds
```

```{r rddensity and rddensity plot, echo=FALSE}
rdd = rddensity(X = df_voter_data$modeldate, c= as.integer(as.Date("2018-04-02")), bwselect = "each", p=1, all = TRUE, kernel = "triangular")

rdplot <- rdplotdensity(rdd, X = df_voter_data$modeldate)


rdd = rddensity(X = df_voter_data$modeldate, c= as.integer(as.Date("2018-07-06")), bwselect = "each", p=1, all = TRUE, kernel = "triangular")

rdplot <- rdplotdensity(rdd, X = df_voter_data$modeldate)

```

# Conclusion

# Reference
